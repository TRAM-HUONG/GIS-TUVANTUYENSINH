{% extends "layout/layout.html" %}
{% load static %}

{% block title %}Báº£n Ä‘á»“ tÆ° váº¥n tuyá»ƒn sinh{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/map.css' %}">
{% endblock %}

{% block content %}
<div class="map-ui">

  <!-- ğŸ§© Sidebar Bá»™ lá»c (UI tÄ©nh) -->
  <aside class="filter">
    <div class="filter__head">
      <h2>ğŸ§­ Bá»™ lá»c</h2>
      <p>Lá»c theo nhu cáº§u / khÃ´ng gian (UI trÆ°á»›c, chÆ°a xá»­ lÃ½).</p>
    </div>

    <!-- âœ… Tabs -->
    <div class="filter__tabs" role="tablist" aria-label="Bá»™ lá»c tabs">
      <button type="button"
              class="tab tab--active"
              role="tab"
              aria-selected="true"
              aria-controls="tab-need"
              id="tab-need-btn">
        ğŸ¯ Lá»c theo nhu cáº§u
      </button>

      <button type="button"
              class="tab"
              role="tab"
              aria-selected="false"
              aria-controls="tab-space"
              id="tab-space-btn">
        ğŸŒ Lá»c theo khÃ´ng gian
      </button>
    </div>

    <!-- âœ… Tab content: Lá»c theo nhu cáº§u -->
    <div class="tab__panel tab__panel--active"
         id="tab-need"
         role="tabpanel"
         aria-labelledby="tab-need-btn">

      <div class="field">
        <label for="kw">ğŸ” Tá»« khÃ³a</label>
        <input id="kw" type="text" placeholder="TÃªn trÆ°á»ng / ngÃ nh..." />
      </div>

      <div class="field">
        <label for="city">ğŸ“ Tá»‰nh/ThÃ nh</label>
        <select id="city">
          <option value="">-- Chá»n --</option>
          <option>TP.HCM</option>
          <option>HÃ  Ná»™i</option>
          <option>ÄÃ  Náºµng</option>
        </select>
      </div>

      <div class="field">
        <label for="khoi">ğŸ§® Khá»‘i xÃ©t tuyá»ƒn</label>
        <select id="khoi">
          <option value="">-- Táº¥t cáº£ --</option>
          <option>A00</option>
          <option>A01</option>
          <option>D01</option>
        </select>
      </div>

      <div class="field">
        <label for="score">ğŸ“Š Äiá»ƒm tá»‘i thiá»ƒu</label>
        <input id="score" type="number" min="0" max="30" step="0.25" placeholder="VD: 22.5" />
      </div>

      <div class="field">
        <label>ğŸ§© NgÃ nh quan tÃ¢m</label>
        <div class="chips">
          <button type="button" class="chip">CNTT</button>
          <button type="button" class="chip">AI</button>
          <button type="button" class="chip">Data</button>
          <button type="button" class="chip">Kinh táº¿</button>
        </div>
      </div>
    </div>

    <!-- âœ… Tab content: Lá»c theo khÃ´ng gian -->
    <div class="tab__panel"
         id="tab-space"
         role="tabpanel"
         aria-labelledby="tab-space-btn"
         hidden>

      <div class="field">
        <label for="near">ğŸ“Œ Gáº§n trong bÃ¡n kÃ­nh (km)</label>
        <input id="near" type="number" min="1" max="200" step="1" placeholder="VD: 10" />
      </div>
      <div class="field">
        <label for="sortdist">ğŸ“ Sáº¯p xáº¿p</label>
        <select id="sortdist">
          <option value="">-- Chá»n --</option>
          <option value="nearest">Gáº§n nháº¥t trÆ°á»›c</option>
          <option value="farthest">Xa nháº¥t trÆ°á»›c</option>
        </select>
      </div>
    </div>

    <div class="filter__actions">
      <button type="button" class="btn btn--primary">Ãp dá»¥ng</button>
      <button type="button" class="btn btn--ghost">Reset</button>
    </div>

    <div class="result">
      <div class="result__head">
        <h3>ğŸ“Œ Káº¿t quáº£</h3>
        <span class="badge">2</span>
      </div>

      <div class="result__list">
        <a class="card" href="#">
          <div class="card__title">ÄH BÃ¡ch Khoa TP.HCM</div>
          <div class="card__meta">TP.HCM â€¢ CNTT â€¢ ~26.5</div>
        </a>

        <a class="card" href="#">
          <div class="card__title">ÄH KHTN</div>
          <div class="card__meta">TP.HCM â€¢ AI/Data â€¢ ~25.0</div>
        </a>
      </div>
    </div>
  </aside>

  <!-- ğŸ—ºï¸ Khu báº£n Ä‘á»“ -->
  <main class="map">
    <div class="map__top">
      <div class="map__title">
        <h1>ğŸ—ºï¸ Báº£n Ä‘á»“ ná»n (khÃ´ng marker)</h1>
        <p>Chá»‰ hiá»ƒn thá»‹ báº£n Ä‘á»“, chÆ°a hiá»ƒn thá»‹ vá»‹ trÃ­ Ä‘áº¡i há»c.</p>
      </div>

      <div class="map__tools">
        <a class="tool tool--link"
           href="https://www.openstreetmap.org/#map=12/10.80/106.67"
           target="_blank" rel="noopener"
           title="Má»Ÿ báº£n Ä‘á»“ lá»›n">â†—</a>
      </div>
    </div>

    <section class="map__frame" aria-label="map">
      <!-- âœ… OpenStreetMap iframe (map ná»n) -->
      <iframe
        class="map__iframe"
        src="https://www.openstreetmap.org/export/embed.html?bbox=106.55%2C10.70%2C106.80%2C10.90&layer=mapnik"
        loading="lazy"
        referrerpolicy="no-referrer-when-downgrade"
        title="OpenStreetMap"
      ></iframe>

      <!-- âœ… Attribution nhá» gá»n (báº¯t buá»™c lá»‹ch sá»±) -->
      <div class="map__note">
        Dá»¯ liá»‡u báº£n Ä‘á»“ Â© OpenStreetMap contributors
      </div>
    </section>
  </main>

</div>

<!-- âœ… JS: báº¥m tab Ä‘á»•i panel -->
<script>
  (function () {
    const tabs = document.querySelectorAll('.filter__tabs [role="tab"]');
    const panels = document.querySelectorAll('.tab__panel[role="tabpanel"]');

    function activateTab(tab) {
      const targetId = tab.getAttribute('aria-controls');

      // reset tabs
      tabs.forEach(t => {
        t.classList.remove('tab--active');
        t.setAttribute('aria-selected', 'false');
      });

      // hide panels
      panels.forEach(p => {
        p.classList.remove('tab__panel--active');
        p.setAttribute('hidden', 'hidden');
      });

      // active clicked tab
      tab.classList.add('tab--active');
      tab.setAttribute('aria-selected', 'true');

      // show target panel
      const panel = document.getElementById(targetId);
      if (panel) {
        panel.classList.add('tab__panel--active');
        panel.removeAttribute('hidden');
      }
    }

    tabs.forEach(tab => {
      tab.addEventListener('click', () => activateTab(tab));
    });
  })();
</script>
{% endblock %}
